<!--pages/register/register.wxml-->
<view class="register-container">
  <!-- 头部 -->
  <view class="header-section">
    <view class="logo-circle">🌱</view>
    <view class="app-name">采摘智工</view>
    <view class="app-desc">农业劳动力全生命周期管理平台</view>
  </view>

  <!-- 注册表单卡片 -->
  <view class="register-card">
    <view class="card-title">创建账号</view>
    <view class="card-subtitle">请填写真实信息，用于身份核验</view>

    <!-- 步骤指示 -->
    <view class="steps">
      <view class="step active">
        <view class="step-dot">1</view>
        <text class="step-label">基本信息</text>
      </view>
      <view class="step-line"></view>
      <view class="step {{emergencyContact || emergencyPhone ? 'active' : ''}}">
        <view class="step-dot">2</view>
        <text class="step-label">紧急联系人</text>
      </view>
    </view>

    <!-- 基本信息分组 -->
    <view class="form-section">
      <view class="section-label">
        <text class="section-icon">👤</text>
        <text>基本信息</text>
      </view>

      <view class="form-item">
        <view class="input-wrapper {{nameFocus ? 'focus' : ''}}">
          <text class="input-icon">📝</text>
          <input 
            class="input-field" 
            type="text" 
            placeholder="真实姓名"
            placeholder-class="placeholder"
            value="{{name}}"
            bindinput="onInputName"
            bindfocus="onNameFocus"
            bindblur="onNameBlur"
          />
          <text class="required-star">*</text>
        </view>
      </view>

      <view class="form-item">
        <view class="input-wrapper {{idCardFocus ? 'focus' : ''}}">
          <text class="input-icon">🆔</text>
          <input 
            class="input-field" 
            type="idcard" 
            placeholder="18位身份证号码"
            placeholder-class="placeholder"
            value="{{idCard}}"
            bindinput="onInputIdCard"
            bindfocus="onIdCardFocus"
            bindblur="onIdCardBlur"
            maxlength="18"
          />
          <text class="required-star">*</text>
        </view>
        <view class="input-hint" wx:if="{{idCard && idCard.length > 0 && idCard.length !== 18}}">
          <text class="hint-text">还需输入 {{18 - idCard.length}} 位</text>
        </view>
        <view class="input-hint success" wx:if="{{idCard.length === 18}}">
          <text class="hint-text">✓ 格式正确</text>
        </view>
      </view>

      <view class="form-item">
        <view class="input-wrapper {{phoneFocus ? 'focus' : ''}}">
          <text class="input-icon">📱</text>
          <input 
            class="input-field" 
            type="number" 
            placeholder="11位手机号码"
            placeholder-class="placeholder"
            value="{{phone}}"
            bindinput="onInputPhone"
            bindfocus="onPhoneFocus"
            bindblur="onPhoneBlur"
            maxlength="11"
          />
          <text class="required-star">*</text>
        </view>
        <view class="input-hint success" wx:if="{{phone.length === 11}}">
          <text class="hint-text">✓ 格式正确</text>
        </view>
      </view>
    </view>

    <!-- 紧急联系人分组 -->
    <view class="form-section">
      <view class="section-label">
        <text class="section-icon">🆘</text>
        <text>紧急联系人</text>
        <text class="section-optional">选填</text>
      </view>

      <view class="form-item">
        <view class="input-wrapper">
          <text class="input-icon">👥</text>
          <input 
            class="input-field" 
            type="text" 
            placeholder="姓名及关系，如：李四-配偶"
            placeholder-class="placeholder"
            value="{{emergencyContact}}"
            bindinput="onInputEmergencyContact"
          />
        </view>
      </view>

      <view class="form-item">
        <view class="input-wrapper">
          <text class="input-icon">📞</text>
          <input 
            class="input-field" 
            type="number" 
            placeholder="紧急联系人电话"
            placeholder-class="placeholder"
            value="{{emergencyPhone}}"
            bindinput="onInputEmergencyPhone"
            maxlength="11"
          />
        </view>
      </view>
    </view>

    <!-- 错误提示 -->
    <view class="error-msg" wx:if="{{error}}">
      <text>{{error}}</text>
    </view>

    <!-- 注册按钮 -->
    <button 
      class="register-btn" 
      hover-class="register-btn-hover"
      bindtap="handleRegister"
      loading="{{loading}}"
      disabled="{{loading}}"
    >
      {{loading ? '注册中...' : '立即注册'}}
    </button>

    <!-- 底部 -->
    <view class="footer-links">
      <text class="login-text">已有账号？</text>
      <text class="login-link" bindtap="goToLogin">返回登录</text>
    </view>
  </view>
</view>
