# 快速开始指南

## 一、启动后端服务

```bash
# 1. 进入后端目录
cd app/backend

# 2. 安装依赖（首次运行）
npm install

# 3. 配置环境变量
# 创建 .env 文件，内容如下：
# DB_HOST=localhost
# DB_PORT=3306
# DB_USERNAME=root
# DB_PASSWORD=your_password
# DB_DATABASE=pickpass_db
# JWT_SECRET=super_secret_key_for_course_design_2025
# AES_KEY=CaiZhiTong2025AES32ByteKey123456
# AES_IV=0123456789012345

# 4. 启动服务
npm run start:dev
```

后端服务启动后：
- API地址：`http://localhost:3001/api`
- Swagger文档：`http://localhost:3001/docs`

## 二、配置微信小程序

### 1. 打开微信开发者工具

1. 下载并安装[微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. 使用微信扫码登录

### 2. 导入项目

1. 点击"导入项目"
2. 项目目录选择：`/Users/yurukuangliu/Desktop/移动应用开发/数据库应用系统大作业/miniprogram`
3. AppID：
   - 如果有小程序账号，填写你的AppID
   - 如果没有，选择"测试号"或"不使用云服务"
4. 项目名称：采摘通
5. 点击"导入"

### 3. 配置API地址

编辑 `miniprogram/app.js`，确保 `baseUrl` 正确：

```javascript
globalData: {
  baseUrl: 'http://localhost:3001/api', // 开发环境
}
```

### 4. 关闭域名校验（开发环境）

1. 在微信开发者工具中，点击右上角"详情"
2. 选择"本地设置"
3. 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"

### 5. 创建TabBar图标（可选）

如果暂时没有图标，可以：
1. 暂时注释掉 `app.json` 中的 `tabBar` 配置
2. 或者创建简单的图标文件放在 `miniprogram/images/` 目录

## 三、测试功能

### 1. 测试用户注册

1. 在小程序中点击"注册"
2. 填写信息：
   - 姓名：测试用户
   - 身份证号：330106199001011234
   - 手机号：13800138000
   - 紧急联系人（可选）
3. 点击"注册"
4. 注册成功后，系统会返回UID

### 2. 测试用户登录

1. 在小程序中点击"登录"
2. 输入：
   - 手机号：13800138000
   - 身份证后6位：011234
3. 点击"登录"
4. 登录成功后，会跳转到首页

### 3. 测试获取二维码

1. 登录后，点击底部"我的码"
2. 系统会显示个人身份码（用于签到）
3. 可以点击"刷新"重新生成

### 4. 测试查看个人信息

1. 登录后，点击底部"我的"
2. 查看个人信息，包括：
   - 姓名、UID
   - 手机号
   - 紧急联系人信息
   - 信息审核状态

### 5. 使用Swagger测试其他功能

1. 打开浏览器访问：`http://localhost:3001/docs`
2. 点击右上角"Authorize"，输入token（登录后获取）
3. 测试各个API接口

## 四、常见问题

### Q1: 小程序无法连接后端

**A**: 检查以下几点：
1. 后端服务是否已启动（`http://localhost:3001`）
2. `app.js` 中的 `baseUrl` 是否正确
3. 是否已关闭域名校验
4. 如果使用真机调试，需要将 `baseUrl` 改为电脑内网IP

### Q2: 真机调试连接失败

**A**: 
1. 确保手机和电脑在同一WiFi网络
2. 将 `app.js` 中的 `baseUrl` 改为电脑内网IP，如：`http://192.168.1.100:3001/api`
3. 在微信开发者工具中关闭域名校验

### Q3: 登录后提示token过期

**A**: 
1. 重新登录获取新token
2. 检查后端 `.env` 文件中的 `JWT_SECRET` 配置

### Q4: 找不到TabBar图标

**A**: 
1. 创建图标文件放在 `miniprogram/images/` 目录
2. 或者暂时注释掉 `app.json` 中的 `tabBar` 配置

## 五、下一步

1. 完善其他页面（基地列表、基地详情、岗位申请等）
2. 添加更多功能（工资查询、申请记录等）
3. 优化UI界面
4. 添加错误处理和加载状态
5. 集成真实的OCR和短信服务

---

**提示**：详细的功能测试步骤请参考 `测试指南.md`
